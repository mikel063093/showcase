<html>
	<!-- Bootstrap core CSS -->
    <link href="{{asset('bundles/app/css/bootstrap.css')}}" rel="stylesheet">
    <!--external css-->
    <link href="{{asset('bundles/app/font-awesome/css/font-awesome.css')}}" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="{{asset('bundles/app/js/gritter/css/jquery.gritter.css')}}" />
        
    <!-- Custom styles for this template -->
    <link href="{{asset('bundles/app/css/style.css')}}" rel="stylesheet">
    <link href="{{asset('bundles/app/css/style-responsive.css')}}" rel="stylesheet">
	
<head>
	<title>Registro</title>
</head>
<body>
	<form id="form-registro" method="post" action="{{path('registrar')}}">
		<div >
			<label>Nombres:</label>
			<input name="nombres" id="nombres" type="text" placeholder="Nombres">
		</div>
		<div>
			<label>Apellidos:</label>
			<input name="apellidos" id="apellidos" type="text" placeholder="Apellidos">
		</div>
		<div>
			<label>Correo:</label>
			<input name="correo" id="correo" type="text" placeholder="Correo Electronico">
		</div>
		<div>
			<label>Contrase単a:</label>
			<input name="pass" id="pass" type="password" placeholder="Contrase単a">
		</div>
		<div>
			<label>Confirmar Cotrase単a</label>
			<input name="passConfirm" id="passConfirm" type="password" placeholder="Confirmar Contrase単a">
		</div>
		
		<div>
			<button type="submit">Registrarse</button>
		</div>
	</form>

	<script src="{{asset('bundles/app/js/jquery.js')}}"></script>
    <script src="{{asset('bundles/app/js/jquery-1.8.3.min.js')}}"></script>
    <script src="{{asset('bundles/app/js/bootstrap.min.js')}}"></script>
    <script class="include" type="text/javascript" src="{{asset('bundles/app/js/jquery.dcjqaccordion.2.7.js')}}"></script>
    <script src="{{asset('bundles/app/js/jquery.scrollTo.min.js')}}"></script>
    <script src="{{asset('bundles/app/js/jquery.nicescroll.js')}}" type="text/javascript"></script>
    <script src="{{asset('bundles/app/js/jquery-validate/jquery.validate.js')}}" type="text/javascript"></script>

    <!--common script for all pages-->
    <script src="{{asset('bundles/app/js/common-scripts.js')}}"></script>

    <!--script for this page-->
    <script type="text/javascript" src="{{asset('bundles/app/js/gritter/js/jquery.gritter.js')}}"></script>
    
    <script type="text/javascript">
    	function mostrarMensaje(mensaje,estado){
    		$.gritter.add({
	            // (string | mandatory) the heading of the notification
	            title: estado,
	            // (string | mandatory) the text inside the notification
	            text: mensaje,
	            // (bool | optional) if you want it to fade out on its own or just sit there
	            sticky: true,
	            // (int | optional) the time you want it to be alive for before fading out
	            time: '',
	            // (string | optional) the class name you want to apply to that specific message
	            class_name: 'my-sticky-class'
	        });

    	};
        function enviar(form){
            var datos = $('#form-registro').serialize();
            $.ajax({
                url:"{{path('registrar')}}",
                type: 'post',
                dataType: 'json',
                data: datos,
                success: function (data){
                    if(data.valor){
                        
                        mostrarMensaje('Usuario creado con exito','Exito');
                        window.location.href="{{web.servidor}}{{path('user')}}";
                    }
                }

            });

        }
    	$('#form-registro').validate({
                rules: {
                    'nombres': {  required: true },
                    'apellidos': {  required: true },
                    'correo': {  required: true, email:true },
                    'pass': {  required: true },
                    'passConfirm': {  required: true, equalTo: "#pass" }
                },
                submitHandler: function(form) {
                   enviar(form);
                },
                showErrors: function(errorMap, errorList) {
                    if (errorList.length > 0) {
                    }
                },
                invalidHandler: function(event, validator) {
                    if (validator.errorList.length > 0) {
                    	for (var i = 0; i < validator.errorList.length; i++) {
                    		mostrarMensaje(validator.errorList[i].message,'Error');
                    	};
                        return false;
                    }
                },
                errorPlacement: function(error, element) {
                    return false;
                }
            });

    </script>

</body>
</html>